{"ast":null,"code":"import{cond,sub,divide,multiply,sqrt,add,block,set,exp,sin,cos,eq,or,neq,and,lessThan,greaterThan}from\"../base\";import{min,abs}from\"../derived\";import AnimatedValue from\"../core/InternalAnimatedValue\";var MAX_STEPS_MS=64;export default function spring(clock,state,config){var lastTime=cond(state.time,state.time,clock);var deltaTime=min(sub(clock,lastTime),MAX_STEPS_MS);var c=config.damping;var m=config.mass;var k=config.stiffness;var v0=multiply(-1,state.velocity);var x0=sub(config.toValue,state.position);var zeta=divide(c,multiply(2,sqrt(multiply(k,m))));var omega0=sqrt(divide(k,m));var omega1=multiply(omega0,sqrt(sub(1,multiply(zeta,zeta))));var t=divide(deltaTime,1000);var sin1=sin(multiply(omega1,t));var cos1=cos(multiply(omega1,t));var underDampedEnvelope=exp(multiply(-1,zeta,omega0,t));var underDampedFrag1=multiply(underDampedEnvelope,add(multiply(sin1,divide(add(v0,multiply(zeta,omega0,x0)),omega1)),multiply(x0,cos1)));var underDampedPosition=sub(config.toValue,underDampedFrag1);var underDampedVelocity=sub(multiply(zeta,omega0,underDampedFrag1),multiply(underDampedEnvelope,sub(multiply(cos1,add(v0,multiply(zeta,omega0,x0))),multiply(omega1,x0,sin1))));var criticallyDampedEnvelope=exp(multiply(-1,omega0,t));var criticallyDampedPosition=sub(config.toValue,multiply(criticallyDampedEnvelope,add(x0,multiply(add(v0,multiply(omega0,x0)),t))));var criticallyDampedVelocity=multiply(criticallyDampedEnvelope,add(multiply(v0,sub(multiply(t,omega0),1)),multiply(t,x0,omega0,omega0)));var prevPosition=state.prevPosition?state.prevPosition:new AnimatedValue(0);var isOvershooting=cond(and(config.overshootClamping,neq(config.stiffness,0)),cond(lessThan(prevPosition,config.toValue),greaterThan(state.position,config.toValue),lessThan(state.position,config.toValue)));var isVelocity=lessThan(abs(state.velocity),config.restSpeedThreshold);var isDisplacement=or(eq(config.stiffness,0),lessThan(abs(sub(config.toValue,state.position)),config.restDisplacementThreshold));return block([set(prevPosition,state.position),cond(lessThan(zeta,1),[set(state.position,underDampedPosition),set(state.velocity,underDampedVelocity)],[set(state.position,criticallyDampedPosition),set(state.velocity,criticallyDampedVelocity)]),set(state.time,clock),cond(or(isOvershooting,and(isVelocity,isDisplacement)),[cond(neq(config.stiffness,0),[set(state.velocity,0),set(state.position,config.toValue)]),set(state.finished,1)])]);}","map":{"version":3,"sources":["/media/blackwolf08/Data/New Projects/Covid-19/COVID19/node_modules/react-native-reanimated/src/animations/spring.js"],"names":["cond","sub","divide","multiply","sqrt","add","block","set","exp","sin","cos","eq","or","neq","and","lessThan","greaterThan","min","abs","AnimatedValue","MAX_STEPS_MS","spring","clock","state","config","lastTime","time","deltaTime","c","damping","m","mass","k","stiffness","v0","velocity","x0","toValue","position","zeta","omega0","omega1","t","sin1","cos1","underDampedEnvelope","underDampedFrag1","underDampedPosition","underDampedVelocity","criticallyDampedEnvelope","criticallyDampedPosition","criticallyDampedVelocity","prevPosition","isOvershooting","overshootClamping","isVelocity","restSpeedThreshold","isDisplacement","restDisplacementThreshold","finished"],"mappings":"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","sourcesContent":["import {\n  cond,\n  sub,\n  divide,\n  multiply,\n  sqrt,\n  add,\n  block,\n  set,\n  exp,\n  sin,\n  cos,\n  eq,\n  or,\n  neq,\n  and,\n  lessThan,\n  greaterThan,\n} from '../base';\nimport { min, abs } from '../derived';\nimport AnimatedValue from '../core/InternalAnimatedValue';\n\nconst MAX_STEPS_MS = 64;\n\nexport default function spring(clock, state, config) {\n  const lastTime = cond(state.time, state.time, clock);\n\n  const deltaTime = min(sub(clock, lastTime), MAX_STEPS_MS);\n\n  const c = config.damping;\n  const m = config.mass;\n  const k = config.stiffness;\n\n  const v0 = multiply(-1, state.velocity);\n  const x0 = sub(config.toValue, state.position);\n\n  const zeta = divide(c, multiply(2, sqrt(multiply(k, m)))); // damping ratio\n  const omega0 = sqrt(divide(k, m)); // undamped angular frequency of the oscillator (rad/ms)\n  const omega1 = multiply(omega0, sqrt(sub(1, multiply(zeta, zeta)))); // exponential decay\n\n  const t = divide(deltaTime, 1000); // in seconds\n\n  const sin1 = sin(multiply(omega1, t));\n  const cos1 = cos(multiply(omega1, t));\n\n  // under damped\n  const underDampedEnvelope = exp(multiply(-1, zeta, omega0, t));\n  const underDampedFrag1 = multiply(\n    underDampedEnvelope,\n    add(\n      multiply(sin1, divide(add(v0, multiply(zeta, omega0, x0)), omega1)),\n      multiply(x0, cos1)\n    )\n  );\n  const underDampedPosition = sub(config.toValue, underDampedFrag1);\n  // This looks crazy -- it's actually just the derivative of the oscillation function\n  const underDampedVelocity = sub(\n    multiply(zeta, omega0, underDampedFrag1),\n    multiply(\n      underDampedEnvelope,\n      sub(\n        multiply(cos1, add(v0, multiply(zeta, omega0, x0))),\n        multiply(omega1, x0, sin1)\n      )\n    )\n  );\n\n  // critically damped\n  const criticallyDampedEnvelope = exp(multiply(-1, omega0, t));\n  const criticallyDampedPosition = sub(\n    config.toValue,\n    multiply(\n      criticallyDampedEnvelope,\n      add(x0, multiply(add(v0, multiply(omega0, x0)), t))\n    )\n  );\n  const criticallyDampedVelocity = multiply(\n    criticallyDampedEnvelope,\n    add(\n      multiply(v0, sub(multiply(t, omega0), 1)),\n      multiply(t, x0, omega0, omega0)\n    )\n  );\n\n  // conditions for stopping the spring animations\n  const prevPosition = state.prevPosition\n    ? state.prevPosition\n    : new AnimatedValue(0);\n\n  const isOvershooting = cond(\n    and(config.overshootClamping, neq(config.stiffness, 0)),\n    cond(\n      lessThan(prevPosition, config.toValue),\n      greaterThan(state.position, config.toValue),\n      lessThan(state.position, config.toValue)\n    )\n  );\n  const isVelocity = lessThan(abs(state.velocity), config.restSpeedThreshold);\n  const isDisplacement = or(\n    eq(config.stiffness, 0),\n    lessThan(\n      abs(sub(config.toValue, state.position)),\n      config.restDisplacementThreshold\n    )\n  );\n\n  return block([\n    set(prevPosition, state.position),\n    cond(\n      lessThan(zeta, 1),\n      [\n        set(state.position, underDampedPosition),\n        set(state.velocity, underDampedVelocity),\n      ],\n      [\n        set(state.position, criticallyDampedPosition),\n        set(state.velocity, criticallyDampedVelocity),\n      ]\n    ),\n    set(state.time, clock),\n    cond(or(isOvershooting, and(isVelocity, isDisplacement)), [\n      cond(neq(config.stiffness, 0), [\n        set(state.velocity, 0),\n        set(state.position, config.toValue),\n      ]),\n      set(state.finished, 1),\n    ]),\n  ]);\n}\n"]},"metadata":{},"sourceType":"module"}