{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _inherits from\"@babel/runtime/helpers/inherits\";function _createForOfIteratorHelperLoose(o){var i=0;if(typeof Symbol===\"undefined\"||o[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]==null){if(Array.isArray(o)||(o=_unsupportedIterableToArray(o)))return function(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};};throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}i=o[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();return i.next.bind(i);}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o===\"string\")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n===\"Object\"&&o.constructor)n=o.constructor.name;if(n===\"Map\"||n===\"Set\")return Array.from(n);if(n===\"Arguments\"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _createSuper(Derived){return function(){var Super=_getPrototypeOf(Derived),result;if(_isNativeReflectConstruct()){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import Platform from\"react-native-web/dist/exports/Platform\";import findNodeHandle from\"react-native-web/dist/exports/findNodeHandle\";import ReanimatedModule from\"../ReanimatedModule\";import AnimatedNode from\"./AnimatedNode\";import InternalAnimatedValue from\"./AnimatedValue\";import{createAnimatedAlways}from\"./AnimatedAlways\";import invariant from'fbjs/lib/invariant';import createEventObjectProxyPolyfill from\"./createEventObjectProxyPolyfill\";function sanitizeArgMapping(argMapping){var eventMappings=[];var alwaysNodes=[];var getNode=function getNode(node){if(Platform.OS==='web'){return node;}return node.__nodeID;};var traverse=function traverse(value,path){if(value instanceof InternalAnimatedValue){eventMappings.push(path.concat(getNode(value)));}else if(typeof value==='object'&&value.__val){eventMappings.push(path.concat(getNode(value.__val)));}else if(typeof value==='function'){var node=new InternalAnimatedValue(0);alwaysNodes.push(createAnimatedAlways(value(node)));eventMappings.push(path.concat(getNode(node)));}else if(typeof value==='object'){for(var key in value){traverse(value[key],path.concat(key));}}};invariant(argMapping[0]&&argMapping[0].nativeEvent,'Native driven events only support animated values contained inside `nativeEvent`.');var ev=argMapping[0].nativeEvent;if(typeof ev==='object'){traverse(ev,[]);}else if(typeof ev==='function'){var proxyHandler={get:function get(target,name){if(name==='__isProxy'){return true;}if(!target[name]&&name!=='__val'){target[name]=new Proxy({},proxyHandler);}return target[name];},set:function set(target,prop,value){if(prop==='__val'){target[prop]=value;}}};var proxy=typeof Proxy==='function'?new Proxy({},proxyHandler):createEventObjectProxyPolyfill();alwaysNodes.push(createAnimatedAlways(ev(proxy)));traverse(proxy,[]);}return{eventMappings:eventMappings,alwaysNodes:alwaysNodes};}var AnimatedEvent=function(_AnimatedNode){_inherits(AnimatedEvent,_AnimatedNode);var _super=_createSuper(AnimatedEvent);function AnimatedEvent(argMapping){var _this;var config=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,AnimatedEvent);var _sanitizeArgMapping=sanitizeArgMapping(argMapping),eventMappings=_sanitizeArgMapping.eventMappings,alwaysNodes=_sanitizeArgMapping.alwaysNodes;_this=_super.call(this,{type:'event',argMapping:eventMappings});_this.__isNative=true;_this._alwaysNodes=alwaysNodes;if(Platform.OS==='web'){_this._argMapping=eventMappings;_this.__getHandler=function(){return function(_ref){var nativeEvent=_ref.nativeEvent;for(var _iterator=_createForOfIteratorHelperLoose(_this._argMapping),_step;!(_step=_iterator()).done;){var _ref2=_step.value;var _ref3=_slicedToArray(_ref2,2);var key=_ref3[0];var value=_ref3[1];if(key in nativeEvent)value.setValue(nativeEvent[key]);}};};}return _this;}_createClass(AnimatedEvent,[{key:\"attachEvent\",value:function attachEvent(viewRef,eventName){for(var i=0;i<this._alwaysNodes.length;i++){this._alwaysNodes[i].__attach();}this.__attach();var viewTag=findNodeHandle(viewRef);ReanimatedModule.attachEvent(viewTag,eventName,this.__nodeID);}},{key:\"__onEvaluate\",value:function __onEvaluate(){return 0;}},{key:\"detachEvent\",value:function detachEvent(viewRef,eventName){for(var i=0;i<this._alwaysNodes.length;i++){this._alwaysNodes[i].isNativelyInitialized()&&this._alwaysNodes[i].__detach();}var viewTag=findNodeHandle(viewRef);ReanimatedModule.detachEvent(viewTag,eventName,this.__nodeID);this.__detach();}}]);return AnimatedEvent;}(AnimatedNode);export{AnimatedEvent as default};export function createAnimatedEvent(argMapping,config){return new AnimatedEvent(argMapping,config);}","map":{"version":3,"sources":["/media/blackwolf08/Data/New Projects/Covid-19/COVID19/node_modules/react-native-reanimated/src/core/AnimatedEvent.js"],"names":["ReanimatedModule","AnimatedNode","InternalAnimatedValue","createAnimatedAlways","invariant","createEventObjectProxyPolyfill","sanitizeArgMapping","argMapping","eventMappings","alwaysNodes","getNode","node","Platform","OS","__nodeID","traverse","value","path","push","concat","__val","key","nativeEvent","ev","proxyHandler","get","target","name","Proxy","set","prop","proxy","AnimatedEvent","config","type","__isNative","_alwaysNodes","_argMapping","__getHandler","setValue","viewRef","eventName","i","length","__attach","viewTag","findNodeHandle","attachEvent","isNativelyInitialized","__detach","detachEvent","createAnimatedEvent"],"mappings":"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","sourcesContent":["import { Platform, findNodeHandle } from 'react-native';\nimport ReanimatedModule from '../ReanimatedModule';\n\nimport AnimatedNode from './AnimatedNode';\nimport InternalAnimatedValue from './AnimatedValue';\nimport { createAnimatedAlways } from './AnimatedAlways';\n\nimport invariant from 'fbjs/lib/invariant';\nimport createEventObjectProxyPolyfill from './createEventObjectProxyPolyfill';\n\nfunction sanitizeArgMapping(argMapping) {\n  // Find animated values in `argMapping` and create an array representing their\n  // key path inside the `nativeEvent` object. Ex.: ['contentOffset', 'x'].\n  const eventMappings = [];\n  const alwaysNodes = [];\n\n  const getNode = node => {\n    if (Platform.OS === 'web') {\n      return node;\n    }\n    return node.__nodeID;\n  };\n\n  const traverse = (value, path) => {\n    if (value instanceof InternalAnimatedValue) {\n      eventMappings.push(path.concat(getNode(value)));\n    } else if (typeof value === 'object' && value.__val) {\n      eventMappings.push(path.concat(getNode(value.__val)));\n    } else if (typeof value === 'function') {\n      const node = new InternalAnimatedValue(0);\n      alwaysNodes.push(createAnimatedAlways(value(node)));\n      eventMappings.push(path.concat(getNode(node)));\n    } else if (typeof value === 'object') {\n      for (const key in value) {\n        traverse(value[key], path.concat(key));\n      }\n    }\n  };\n\n  invariant(\n    argMapping[0] && argMapping[0].nativeEvent,\n    'Native driven events only support animated values contained inside `nativeEvent`.'\n  );\n\n  // Assume that the event containing `nativeEvent` is always the first argument.\n  const ev = argMapping[0].nativeEvent;\n  if (typeof ev === 'object') {\n    traverse(ev, []);\n  } else if (typeof ev === 'function') {\n    const proxyHandler = {\n      get: function(target, name) {\n        if (name === '__isProxy') {\n          return true;\n        }\n        if (!target[name] && name !== '__val') {\n          target[name] = new Proxy({}, proxyHandler);\n        }\n        return target[name];\n      },\n      set: function(target, prop, value) {\n        if (prop === '__val') {\n          target[prop] = value;\n        }\n      },\n    };\n\n    const proxy =\n      typeof Proxy === 'function'\n        ? new Proxy({}, proxyHandler)\n        : createEventObjectProxyPolyfill();\n    alwaysNodes.push(createAnimatedAlways(ev(proxy)));\n    traverse(proxy, []);\n  }\n\n  return { eventMappings, alwaysNodes };\n}\n\nexport default class AnimatedEvent extends AnimatedNode {\n  constructor(argMapping, config = {}) {\n    const { eventMappings, alwaysNodes } = sanitizeArgMapping(argMapping);\n    super({ type: 'event', argMapping: eventMappings });\n    this._alwaysNodes = alwaysNodes;\n    if (Platform.OS === 'web') {\n      this._argMapping = eventMappings;\n      this.__getHandler = () => {\n        return ({ nativeEvent }) => {\n          for (const [key, value] of this._argMapping) {\n            if (key in nativeEvent) value.setValue(nativeEvent[key]);\n          }\n        };\n      };\n    }\n  }\n\n  // The below field is a temporary workaround to make AnimatedEvent object be recognized\n  // as Animated.event event callback and therefore filtered out from being send over the\n  // bridge which was causing the object to be frozen in JS.\n  __isNative = true;\n\n  attachEvent(viewRef, eventName) {\n    for (let i = 0; i < this._alwaysNodes.length; i++) {\n      this._alwaysNodes[i].__attach();\n    }\n    this.__attach();\n    const viewTag = findNodeHandle(viewRef);\n    ReanimatedModule.attachEvent(viewTag, eventName, this.__nodeID);\n  }\n\n  __onEvaluate() {\n    return 0;\n  }\n\n  detachEvent(viewRef, eventName) {\n    for (let i = 0; i < this._alwaysNodes.length; i++) {\n      this._alwaysNodes[i].isNativelyInitialized() &&\n        this._alwaysNodes[i].__detach();\n    }\n    const viewTag = findNodeHandle(viewRef);\n    ReanimatedModule.detachEvent(viewTag, eventName, this.__nodeID);\n    this.__detach();\n  }\n}\n\nexport function createAnimatedEvent(argMapping, config) {\n  return new AnimatedEvent(argMapping, config);\n}\n"]},"metadata":{},"sourceType":"module"}