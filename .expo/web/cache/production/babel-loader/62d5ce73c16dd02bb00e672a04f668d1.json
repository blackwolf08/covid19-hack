{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _extends from\"@babel/runtime/helpers/extends\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _inherits from\"@babel/runtime/helpers/inherits\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){return function(){var Super=_getPrototypeOf(Derived),result;if(_isNativeReflectConstruct()){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React from\"react\";import View from\"react-native-web/dist/exports/View\";import{Svg,G,Text,Rect}from\"react-native-svg\";import _ from\"lodash\";import AbstractChart from\"../abstract-chart\";import{DAYS_IN_WEEK,MILLISECONDS_IN_ONE_DAY,MONTH_LABELS}from\"./constants\";import{shiftDate,getBeginningTimeForDate,convertToDate}from\"./dateHelpers\";var SQUARE_SIZE=20;var MONTH_LABEL_GUTTER_SIZE=8;var paddingLeft=32;function mapValue(x,in_min,in_max,out_min,out_max){return(x-in_min)*(out_max-out_min)/(in_max-in_min)+out_min;}var ContributionGraph=function(_AbstractChart){_inherits(ContributionGraph,_AbstractChart);var _super=_createSuper(ContributionGraph);function ContributionGraph(props){var _this;_classCallCheck(this,ContributionGraph);_this=_super.call(this,props);var _this$getValueCache=_this.getValueCache(props.values),maxValue=_this$getValueCache.maxValue,minValue=_this$getValueCache.minValue,valueCache=_this$getValueCache.valueCache;_this.state={maxValue:maxValue,minValue:minValue,valueCache:valueCache};return _this;}_createClass(ContributionGraph,[{key:\"componentWillReceiveProps\",value:function componentWillReceiveProps(nextProps){var _this$getValueCache2=this.getValueCache(nextProps.values),maxValue=_this$getValueCache2.maxValue,minValue=_this$getValueCache2.minValue,valueCache=_this$getValueCache2.valueCache;this.setState({maxValue:maxValue,minValue:minValue,valueCache:valueCache});}},{key:\"getSquareSizeWithGutter\",value:function getSquareSizeWithGutter(){return(this.props.squareSize||SQUARE_SIZE)+this.props.gutterSize;}},{key:\"getMonthLabelSize\",value:function getMonthLabelSize(){var _this$props$squareSiz=this.props.squareSize,squareSize=_this$props$squareSiz===void 0?SQUARE_SIZE:_this$props$squareSiz;if(!this.props.showMonthLabels){return 0;}if(this.props.horizontal){return squareSize+MONTH_LABEL_GUTTER_SIZE;}return 2*(squareSize+MONTH_LABEL_GUTTER_SIZE);}},{key:\"getStartDate\",value:function getStartDate(){return shiftDate(this.getEndDate(),-this.props.numDays+1);}},{key:\"getEndDate\",value:function getEndDate(){return getBeginningTimeForDate(convertToDate(this.props.endDate));}},{key:\"getStartDateWithEmptyDays\",value:function getStartDateWithEmptyDays(){return shiftDate(this.getStartDate(),-this.getNumEmptyDaysAtStart());}},{key:\"getNumEmptyDaysAtStart\",value:function getNumEmptyDaysAtStart(){return this.getStartDate().getDay();}},{key:\"getNumEmptyDaysAtEnd\",value:function getNumEmptyDaysAtEnd(){return DAYS_IN_WEEK-1-this.getEndDate().getDay();}},{key:\"getWeekCount\",value:function getWeekCount(){var numDaysRoundedToWeek=this.props.numDays+this.getNumEmptyDaysAtStart()+this.getNumEmptyDaysAtEnd();return Math.ceil(numDaysRoundedToWeek/DAYS_IN_WEEK);}},{key:\"getWeekWidth\",value:function getWeekWidth(){return DAYS_IN_WEEK*this.getSquareSizeWithGutter();}},{key:\"getWidth\",value:function getWidth(){return this.getWeekCount()*this.getSquareSizeWithGutter()-this.props.gutterSize;}},{key:\"getHeight\",value:function getHeight(){return this.getWeekWidth()+(this.getMonthLabelSize()-this.props.gutterSize);}},{key:\"getValueCache\",value:function getValueCache(values){var _this2=this;var minValue=Infinity,maxValue=-Infinity;return{valueCache:values.reduce(function(memo,value){var date=convertToDate(value.date);var index=Math.floor((date-_this2.getStartDateWithEmptyDays())/MILLISECONDS_IN_ONE_DAY);minValue=Math.min(value.count,minValue);maxValue=Math.max(value.count,maxValue);memo[index]={value:value,title:_this2.props.titleForValue?_this2.props.titleForValue(value):null,tooltipDataAttrs:_this2.getTooltipDataAttrsForValue(value)};return memo;},{}),minValue:minValue,maxValue:maxValue};}},{key:\"getValueForIndex\",value:function getValueForIndex(index){if(this.state.valueCache[index]){return this.state.valueCache[index].value;}return null;}},{key:\"getClassNameForIndex\",value:function getClassNameForIndex(index){if(this.state.valueCache[index]){if(this.state.valueCache[index].value){var count=this.state.valueCache[index].value.count;if(count){var opacity=mapValue(count,this.state.minValue,this.state.maxValue,0.15+0.05,1);return this.props.chartConfig.color(opacity);}}}return this.props.chartConfig.color(0.15);}},{key:\"getTitleForIndex\",value:function getTitleForIndex(index){if(this.state.valueCache[index]){return this.state.valueCache[index].title;}return this.props.titleForValue?this.props.titleForValue(null):null;}},{key:\"getTooltipDataAttrsForIndex\",value:function getTooltipDataAttrsForIndex(index){if(this.state.valueCache[index]){return this.state.valueCache[index].tooltipDataAttrs;}return this.getTooltipDataAttrsForValue({date:null,count:null});}},{key:\"getTooltipDataAttrsForValue\",value:function getTooltipDataAttrsForValue(value){var tooltipDataAttrs=this.props.tooltipDataAttrs;if(typeof tooltipDataAttrs===\"function\"){return tooltipDataAttrs(value);}return tooltipDataAttrs;}},{key:\"getTransformForWeek\",value:function getTransformForWeek(weekIndex){if(this.props.horizontal){return[weekIndex*this.getSquareSizeWithGutter(),50];}return[10,weekIndex*this.getSquareSizeWithGutter()];}},{key:\"getTransformForMonthLabels\",value:function getTransformForMonthLabels(){if(this.props.horizontal){return null;}return this.getWeekWidth()+MONTH_LABEL_GUTTER_SIZE+\", 0\";}},{key:\"getTransformForAllWeeks\",value:function getTransformForAllWeeks(){if(this.props.horizontal){return\"0, \"+(this.getMonthLabelSize()-100);}return null;}},{key:\"getViewBox\",value:function getViewBox(){if(this.props.horizontal){return this.getWidth()+\" \"+this.getHeight();}return this.getHeight()+\" \"+this.getWidth();}},{key:\"getSquareCoordinates\",value:function getSquareCoordinates(dayIndex){if(this.props.horizontal){return[0,dayIndex*this.getSquareSizeWithGutter()];}return[dayIndex*this.getSquareSizeWithGutter(),0];}},{key:\"getMonthLabelCoordinates\",value:function getMonthLabelCoordinates(weekIndex){if(this.props.horizontal){return[weekIndex*this.getSquareSizeWithGutter(),this.getMonthLabelSize()-MONTH_LABEL_GUTTER_SIZE];}var verticalOffset=-2;return[0,(weekIndex+1)*this.getSquareSizeWithGutter()+verticalOffset];}},{key:\"renderSquare\",value:function renderSquare(dayIndex,index){var _this3=this;var indexOutOfRange=index<this.getNumEmptyDaysAtStart()||index>=this.getNumEmptyDaysAtStart()+this.props.numDays;if(indexOutOfRange&&!this.props.showOutOfRangeDays){return null;}var _this$getSquareCoordi=this.getSquareCoordinates(dayIndex),_this$getSquareCoordi2=_slicedToArray(_this$getSquareCoordi,2),x=_this$getSquareCoordi2[0],y=_this$getSquareCoordi2[1];var _this$props$squareSiz2=this.props.squareSize,squareSize=_this$props$squareSiz2===void 0?SQUARE_SIZE:_this$props$squareSiz2;return React.createElement(Rect,_extends({key:index,width:squareSize,height:squareSize,x:x+paddingLeft,y:y,title:this.getTitleForIndex(index),fill:this.getClassNameForIndex(index),onPress:function onPress(){_this3.handleDayPress(index);}},this.getTooltipDataAttrsForIndex(index)));}},{key:\"handleDayPress\",value:function handleDayPress(index){if(!this.props.onDayPress){return;}this.props.onDayPress(this.state.valueCache[index]&&this.state.valueCache[index].value?this.state.valueCache[index].value:{count:0,date:new Date(this.getStartDate().valueOf()+index*MILLISECONDS_IN_ONE_DAY)});}},{key:\"renderWeek\",value:function renderWeek(weekIndex){var _this4=this;var _this$getTransformFor=this.getTransformForWeek(weekIndex),_this$getTransformFor2=_slicedToArray(_this$getTransformFor,2),x=_this$getTransformFor2[0],y=_this$getTransformFor2[1];return React.createElement(G,{key:weekIndex,x:x,y:y},_.range(DAYS_IN_WEEK).map(function(dayIndex){return _this4.renderSquare(dayIndex,weekIndex*DAYS_IN_WEEK+dayIndex);}));}},{key:\"renderAllWeeks\",value:function renderAllWeeks(){var _this5=this;return _.range(this.getWeekCount()).map(function(weekIndex){return _this5.renderWeek(weekIndex);});}},{key:\"renderMonthLabels\",value:function renderMonthLabels(){var _this6=this;if(!this.props.showMonthLabels){return null;}var weekRange=_.range(this.getWeekCount()-1);return weekRange.map(function(weekIndex){var endOfWeek=shiftDate(_this6.getStartDateWithEmptyDays(),(weekIndex+1)*DAYS_IN_WEEK);var _this6$getMonthLabelC=_this6.getMonthLabelCoordinates(weekIndex),_this6$getMonthLabelC2=_slicedToArray(_this6$getMonthLabelC,2),x=_this6$getMonthLabelC2[0],y=_this6$getMonthLabelC2[1];return endOfWeek.getDate()>=1&&endOfWeek.getDate()<=DAYS_IN_WEEK?React.createElement(Text,_extends({key:weekIndex,x:x+paddingLeft,y:y+8},_this6.getPropsForLabels()),_this6.props.getMonthLabel?_this6.props.getMonthLabel(endOfWeek.getMonth()):MONTH_LABELS[endOfWeek.getMonth()]):null;});}},{key:\"render\",value:function render(){var _this$props$style=this.props.style,style=_this$props$style===void 0?{}:_this$props$style;var _style$borderRadius=style.borderRadius,borderRadius=_style$borderRadius===void 0?0:_style$borderRadius;if(!borderRadius&&this.props.chartConfig.style){var stupidXo=this.props.chartConfig.style.borderRadius;borderRadius=stupidXo;}return React.createElement(View,{style:style},React.createElement(Svg,{height:this.props.height,width:this.props.width},this.renderDefs(_objectSpread({width:this.props.width,height:this.props.height},this.props.chartConfig)),React.createElement(Rect,{width:\"100%\",height:this.props.height,rx:borderRadius,ry:borderRadius,fill:\"url(#backgroundGradient)\"}),React.createElement(G,null,this.renderMonthLabels()),React.createElement(G,null,this.renderAllWeeks())));}}]);return ContributionGraph;}(AbstractChart);ContributionGraph.defaultProps={numDays:200,endDate:new Date(),gutterSize:1,squareSize:SQUARE_SIZE,horizontal:true,showMonthLabels:true,showOutOfRangeDays:false,classForValue:function classForValue(value){return value?\"black\":\"#8cc665\";}};export default ContributionGraph;","map":{"version":3,"sources":["/media/blackwolf08/Data/New Projects/Covid-19/COVID19/node_modules/react-native-chart-kit/src/contribution-graph/index.js"],"names":["React","Svg","G","Text","Rect","_","AbstractChart","DAYS_IN_WEEK","MILLISECONDS_IN_ONE_DAY","MONTH_LABELS","shiftDate","getBeginningTimeForDate","convertToDate","SQUARE_SIZE","MONTH_LABEL_GUTTER_SIZE","paddingLeft","mapValue","x","in_min","in_max","out_min","out_max","ContributionGraph","props","getValueCache","values","maxValue","minValue","valueCache","state","nextProps","setState","squareSize","gutterSize","showMonthLabels","horizontal","getEndDate","numDays","endDate","getStartDate","getNumEmptyDaysAtStart","getDay","numDaysRoundedToWeek","getNumEmptyDaysAtEnd","Math","ceil","getSquareSizeWithGutter","getWeekCount","getWeekWidth","getMonthLabelSize","Infinity","reduce","memo","value","date","index","floor","getStartDateWithEmptyDays","min","count","max","title","titleForValue","tooltipDataAttrs","getTooltipDataAttrsForValue","opacity","chartConfig","color","weekIndex","getWidth","getHeight","dayIndex","verticalOffset","indexOutOfRange","showOutOfRangeDays","getSquareCoordinates","y","getTitleForIndex","getClassNameForIndex","handleDayPress","getTooltipDataAttrsForIndex","onDayPress","Date","valueOf","getTransformForWeek","range","map","renderSquare","renderWeek","weekRange","endOfWeek","getMonthLabelCoordinates","getDate","getPropsForLabels","getMonthLabel","getMonth","style","borderRadius","stupidXo","height","width","renderDefs","renderMonthLabels","renderAllWeeks","defaultProps","classForValue"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { View } from \"react-native\";\nimport { Svg, G, Text, Rect } from \"react-native-svg\";\nimport _ from \"lodash\";\nimport AbstractChart from \"../abstract-chart\";\nimport {\n  DAYS_IN_WEEK,\n  MILLISECONDS_IN_ONE_DAY,\n  MONTH_LABELS\n} from \"./constants\";\nimport {\n  shiftDate,\n  getBeginningTimeForDate,\n  convertToDate\n} from \"./dateHelpers\";\n\nconst SQUARE_SIZE = 20;\nconst MONTH_LABEL_GUTTER_SIZE = 8;\nconst paddingLeft = 32;\n\nfunction mapValue(x, in_min, in_max, out_min, out_max) {\n  return ((x - in_min) * (out_max - out_min)) / (in_max - in_min) + out_min;\n}\n\nclass ContributionGraph extends AbstractChart {\n  constructor(props) {\n    super(props);\n\n    let { maxValue, minValue, valueCache } = this.getValueCache(props.values);\n\n    this.state = {\n      maxValue,\n      minValue,\n      valueCache\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    let { maxValue, minValue, valueCache } = this.getValueCache(\n      nextProps.values\n    );\n\n    this.setState({\n      maxValue,\n      minValue,\n      valueCache\n    });\n  }\n\n  getSquareSizeWithGutter() {\n    return (this.props.squareSize || SQUARE_SIZE) + this.props.gutterSize;\n  }\n\n  getMonthLabelSize() {\n    let { squareSize = SQUARE_SIZE } = this.props;\n    if (!this.props.showMonthLabels) {\n      return 0;\n    }\n    if (this.props.horizontal) {\n      return squareSize + MONTH_LABEL_GUTTER_SIZE;\n    }\n    return 2 * (squareSize + MONTH_LABEL_GUTTER_SIZE);\n  }\n\n  getStartDate() {\n    return shiftDate(this.getEndDate(), -this.props.numDays + 1); // +1 because endDate is inclusive\n  }\n\n  getEndDate() {\n    return getBeginningTimeForDate(convertToDate(this.props.endDate));\n  }\n\n  getStartDateWithEmptyDays() {\n    return shiftDate(this.getStartDate(), -this.getNumEmptyDaysAtStart());\n  }\n\n  getNumEmptyDaysAtStart() {\n    return this.getStartDate().getDay();\n  }\n\n  getNumEmptyDaysAtEnd() {\n    return DAYS_IN_WEEK - 1 - this.getEndDate().getDay();\n  }\n\n  getWeekCount() {\n    const numDaysRoundedToWeek =\n      this.props.numDays +\n      this.getNumEmptyDaysAtStart() +\n      this.getNumEmptyDaysAtEnd();\n    return Math.ceil(numDaysRoundedToWeek / DAYS_IN_WEEK);\n  }\n\n  getWeekWidth() {\n    return DAYS_IN_WEEK * this.getSquareSizeWithGutter();\n  }\n\n  getWidth() {\n    return (\n      this.getWeekCount() * this.getSquareSizeWithGutter() -\n      this.props.gutterSize\n    );\n  }\n\n  getHeight() {\n    return (\n      this.getWeekWidth() + (this.getMonthLabelSize() - this.props.gutterSize)\n    );\n  }\n\n  getValueCache(values) {\n    let minValue = Infinity,\n      maxValue = -Infinity;\n\n    return {\n      valueCache: values.reduce((memo, value) => {\n        const date = convertToDate(value.date);\n        const index = Math.floor(\n          (date - this.getStartDateWithEmptyDays()) / MILLISECONDS_IN_ONE_DAY\n        );\n\n        minValue = Math.min(value.count, minValue);\n        maxValue = Math.max(value.count, maxValue);\n\n        memo[index] = {\n          value,\n          title: this.props.titleForValue\n            ? this.props.titleForValue(value)\n            : null,\n          tooltipDataAttrs: this.getTooltipDataAttrsForValue(value)\n        };\n        return memo;\n      }, {}),\n      minValue,\n      maxValue\n    };\n  }\n\n  getValueForIndex(index) {\n    if (this.state.valueCache[index]) {\n      return this.state.valueCache[index].value;\n    }\n    return null;\n  }\n\n  getClassNameForIndex(index) {\n    if (this.state.valueCache[index]) {\n      if (this.state.valueCache[index].value) {\n        const count = this.state.valueCache[index].value.count;\n\n        if (count) {\n          const opacity = mapValue(\n            count,\n            this.state.minValue,\n            this.state.maxValue,\n            0.15 + 0.05, // + 0.05 to make smaller values a bit more visible\n            1\n          );\n\n          return this.props.chartConfig.color(opacity);\n        }\n      }\n    }\n\n    return this.props.chartConfig.color(0.15);\n  }\n\n  getTitleForIndex(index) {\n    if (this.state.valueCache[index]) {\n      return this.state.valueCache[index].title;\n    }\n    return this.props.titleForValue ? this.props.titleForValue(null) : null;\n  }\n\n  getTooltipDataAttrsForIndex(index) {\n    if (this.state.valueCache[index]) {\n      return this.state.valueCache[index].tooltipDataAttrs;\n    }\n    return this.getTooltipDataAttrsForValue({ date: null, count: null });\n  }\n\n  getTooltipDataAttrsForValue(value) {\n    const { tooltipDataAttrs } = this.props;\n\n    if (typeof tooltipDataAttrs === \"function\") {\n      return tooltipDataAttrs(value);\n    }\n    return tooltipDataAttrs;\n  }\n\n  getTransformForWeek(weekIndex) {\n    if (this.props.horizontal) {\n      return [weekIndex * this.getSquareSizeWithGutter(), 50];\n    }\n    return [10, weekIndex * this.getSquareSizeWithGutter()];\n  }\n\n  getTransformForMonthLabels() {\n    if (this.props.horizontal) {\n      return null;\n    }\n    return `${this.getWeekWidth() + MONTH_LABEL_GUTTER_SIZE}, 0`;\n  }\n\n  getTransformForAllWeeks() {\n    if (this.props.horizontal) {\n      return `0, ${this.getMonthLabelSize() - 100}`;\n    }\n    return null;\n  }\n\n  getViewBox() {\n    if (this.props.horizontal) {\n      return `${this.getWidth()} ${this.getHeight()}`;\n    }\n    return `${this.getHeight()} ${this.getWidth()}`;\n  }\n\n  getSquareCoordinates(dayIndex) {\n    if (this.props.horizontal) {\n      return [0, dayIndex * this.getSquareSizeWithGutter()];\n    }\n    return [dayIndex * this.getSquareSizeWithGutter(), 0];\n  }\n\n  getMonthLabelCoordinates(weekIndex) {\n    if (this.props.horizontal) {\n      return [\n        weekIndex * this.getSquareSizeWithGutter(),\n        this.getMonthLabelSize() - MONTH_LABEL_GUTTER_SIZE\n      ];\n    }\n    const verticalOffset = -2;\n    return [\n      0,\n      (weekIndex + 1) * this.getSquareSizeWithGutter() + verticalOffset\n    ];\n  }\n\n  renderSquare(dayIndex, index) {\n    const indexOutOfRange =\n      index < this.getNumEmptyDaysAtStart() ||\n      index >= this.getNumEmptyDaysAtStart() + this.props.numDays;\n\n    if (indexOutOfRange && !this.props.showOutOfRangeDays) {\n      return null;\n    }\n\n    const [x, y] = this.getSquareCoordinates(dayIndex);\n    const { squareSize = SQUARE_SIZE } = this.props;\n\n    return (\n      <Rect\n        key={index}\n        width={squareSize}\n        height={squareSize}\n        x={x + paddingLeft}\n        y={y}\n        title={this.getTitleForIndex(index)}\n        fill={this.getClassNameForIndex(index)}\n        onPress={() => {\n          this.handleDayPress(index);\n        }}\n        {...this.getTooltipDataAttrsForIndex(index)}\n      />\n    );\n  }\n\n  handleDayPress(index) {\n    if (!this.props.onDayPress) {\n      return;\n    }\n    this.props.onDayPress(\n      this.state.valueCache[index] && this.state.valueCache[index].value\n        ? this.state.valueCache[index].value\n        : {\n            count: 0,\n            date: new Date(\n              this.getStartDate().valueOf() + index * MILLISECONDS_IN_ONE_DAY\n            )\n          }\n    );\n  }\n\n  renderWeek(weekIndex) {\n    const [x, y] = this.getTransformForWeek(weekIndex);\n    return (\n      <G key={weekIndex} x={x} y={y}>\n        {_.range(DAYS_IN_WEEK).map(dayIndex =>\n          this.renderSquare(dayIndex, weekIndex * DAYS_IN_WEEK + dayIndex)\n        )}\n      </G>\n    );\n  }\n\n  renderAllWeeks() {\n    return _.range(this.getWeekCount()).map(weekIndex =>\n      this.renderWeek(weekIndex)\n    );\n  }\n\n  renderMonthLabels() {\n    if (!this.props.showMonthLabels) {\n      return null;\n    }\n    const weekRange = _.range(this.getWeekCount() - 1); // don't render for last week, because label will be cut off\n    return weekRange.map(weekIndex => {\n      const endOfWeek = shiftDate(\n        this.getStartDateWithEmptyDays(),\n        (weekIndex + 1) * DAYS_IN_WEEK\n      );\n      const [x, y] = this.getMonthLabelCoordinates(weekIndex);\n      return endOfWeek.getDate() >= 1 && endOfWeek.getDate() <= DAYS_IN_WEEK ? (\n        <Text\n          key={weekIndex}\n          x={x + paddingLeft}\n          y={y + 8}\n          {...this.getPropsForLabels()}\n        >\n          {this.props.getMonthLabel\n            ? this.props.getMonthLabel(endOfWeek.getMonth())\n            : MONTH_LABELS[endOfWeek.getMonth()]}\n        </Text>\n      ) : null;\n    });\n  }\n\n  render() {\n    const { style = {} } = this.props;\n    let { borderRadius = 0 } = style;\n    if (!borderRadius && this.props.chartConfig.style) {\n      const stupidXo = this.props.chartConfig.style.borderRadius;\n      borderRadius = stupidXo;\n    }\n    return (\n      <View style={style}>\n        <Svg height={this.props.height} width={this.props.width}>\n          {this.renderDefs({\n            width: this.props.width,\n            height: this.props.height,\n            ...this.props.chartConfig\n          })}\n          <Rect\n            width=\"100%\"\n            height={this.props.height}\n            rx={borderRadius}\n            ry={borderRadius}\n            fill=\"url(#backgroundGradient)\"\n          />\n          <G>{this.renderMonthLabels()}</G>\n          <G>{this.renderAllWeeks()}</G>\n        </Svg>\n      </View>\n    );\n  }\n}\n\nContributionGraph.defaultProps = {\n  numDays: 200,\n  endDate: new Date(),\n  gutterSize: 1,\n  squareSize: SQUARE_SIZE,\n  horizontal: true,\n  showMonthLabels: true,\n  showOutOfRangeDays: false,\n  classForValue: value => (value ? \"black\" : \"#8cc665\")\n};\n\nexport default ContributionGraph;\n"]},"metadata":{},"sourceType":"module"}