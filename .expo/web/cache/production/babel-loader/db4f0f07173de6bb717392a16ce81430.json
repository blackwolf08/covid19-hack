{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _inherits from\"@babel/runtime/helpers/inherits\";import _wrapNativeSuper from\"@babel/runtime/helpers/wrapNativeSuper\";function _createSuper(Derived){return function(){var Super=_getPrototypeOf(Derived),result;if(_isNativeReflectConstruct()){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import{EventEmitter}from'@unimodules/core';var GeocoderError=function(_Error){_inherits(GeocoderError,_Error);var _super=_createSuper(GeocoderError);function GeocoderError(){var _this;_classCallCheck(this,GeocoderError);_this=_super.call(this,'Geocoder service is not available for this device.');_this.code='E_NO_GEOCODER';return _this;}return GeocoderError;}(_wrapNativeSuper(Error));var emitter=new EventEmitter({});function positionToJSON(position){if(!position)return null;var _position$coords=position.coords,coords=_position$coords===void 0?{}:_position$coords,timestamp=position.timestamp;return{coords:{latitude:coords.latitude,longitude:coords.longitude,altitude:coords.altitude,accuracy:coords.accuracy,altitudeAccuracy:coords.altitudeAccuracy,heading:coords.heading,speed:coords.speed},timestamp:timestamp};}export default{get name(){return'ExpoLocation';},getProviderStatusAsync:function getProviderStatusAsync(){return _regeneratorRuntime.async(function getProviderStatusAsync$(_context){while(1){switch(_context.prev=_context.next){case 0:return _context.abrupt(\"return\",{locationServicesEnabled:'geolocation'in navigator});case 1:case\"end\":return _context.stop();}}},null,null,null,Promise);},getCurrentPositionAsync:function getCurrentPositionAsync(options){return _regeneratorRuntime.async(function getCurrentPositionAsync$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt(\"return\",new Promise(function(resolve,reject){return navigator.geolocation.getCurrentPosition(function(position){return resolve(positionToJSON(position));},reject,options);}));case 1:case\"end\":return _context2.stop();}}},null,null,null,Promise);},removeWatchAsync:function removeWatchAsync(watchId){return _regeneratorRuntime.async(function removeWatchAsync$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:navigator.geolocation.clearWatch(watchId);case 1:case\"end\":return _context3.stop();}}},null,null,null,Promise);},watchDeviceHeading:function watchDeviceHeading(headingId){return _regeneratorRuntime.async(function watchDeviceHeading$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:console.warn('Location.watchDeviceHeading: is not supported on web');case 1:case\"end\":return _context4.stop();}}},null,null,null,Promise);},hasServicesEnabledAsync:function hasServicesEnabledAsync(){return _regeneratorRuntime.async(function hasServicesEnabledAsync$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:return _context5.abrupt(\"return\",'geolocation'in navigator);case 1:case\"end\":return _context5.stop();}}},null,null,null,Promise);},geocodeAsync:function geocodeAsync(){return _regeneratorRuntime.async(function geocodeAsync$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:throw new GeocoderError();case 1:case\"end\":return _context6.stop();}}},null,null,null,Promise);},reverseGeocodeAsync:function reverseGeocodeAsync(){return _regeneratorRuntime.async(function reverseGeocodeAsync$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:throw new GeocoderError();case 1:case\"end\":return _context7.stop();}}},null,null,null,Promise);},watchPositionImplAsync:function watchPositionImplAsync(watchId,options){return _regeneratorRuntime.async(function watchPositionImplAsync$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:return _context8.abrupt(\"return\",new Promise(function(resolve){watchId=global.navigator.geolocation.watchPosition(function(location){emitter.emit('Expo.locationChanged',{watchId:watchId,location:positionToJSON(location)});},null,options);resolve(watchId);}));case 1:case\"end\":return _context8.stop();}}},null,null,null,Promise);},requestPermissionsAsync:function requestPermissionsAsync(){return _regeneratorRuntime.async(function requestPermissionsAsync$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:return _context9.abrupt(\"return\",new Promise(function(resolve){navigator.geolocation.getCurrentPosition(function(){return resolve({status:'granted'});},function(_ref){var code=_ref.code;if(code===1){resolve({status:'denied'});}else{resolve({status:'undetermined'});}});}));case 1:case\"end\":return _context9.stop();}}},null,null,null,Promise);}};","map":{"version":3,"sources":["../src/ExpoLocation.web.ts"],"names":[],"mappings":"u/BAAA,OAAS,YAAT,KAA6B,kBAA7B,C,GAqBM,CAAA,a,yFAGJ,wBAAA,+CACE,uBAAM,oDAAN,EACA,MAAK,IAAL,CAAY,eAAZ,CAFF,aAGC,C,wCANyB,K,GAS5B,GAAM,CAAA,OAAO,CAAG,GAAI,CAAA,YAAJ,CAAiB,EAAjB,CAAhB,CAEA,QAAS,CAAA,cAAT,CAAwB,QAAxB,CAAqC,CACnC,GAAI,CAAC,QAAL,CAAe,MAAO,KAAP,CADoB,qBAGA,QAHA,CAG3B,MAH2B,CAG3B,MAH2B,2BAGlB,EAHkB,kBAGd,SAHc,CAGA,QAHA,CAGd,SAHc,CAInC,MAAO,CACL,MAAM,CAAE,CACN,QAAQ,CAAE,MAAM,CAAC,QADX,CAEN,SAAS,CAAE,MAAM,CAAC,SAFZ,CAGN,QAAQ,CAAE,MAAM,CAAC,QAHX,CAIN,QAAQ,CAAE,MAAM,CAAC,QAJX,CAKN,gBAAgB,CAAE,MAAM,CAAC,gBALnB,CAMN,OAAO,CAAE,MAAM,CAAC,OANV,CAON,KAAK,CAAE,MAAM,CAAC,KAPR,CADH,CAUL,SAAS,CAAT,SAVK,CAAP,CAYD,CAED,cAAe,CACb,GAAI,CAAA,IAAJ,EAAQ,CACN,MAAO,cAAP,CACD,CAHY,CAIP,sBAJO,mMAKJ,CACL,uBAAuB,CAAE,eAAiB,CAAA,SADrC,CALI,wEASP,uBATO,kCASiB,OATjB,uKAUJ,GAAI,CAAA,OAAJ,CAA6B,SAAC,OAAD,CAAU,MAAV,QAClC,CAAA,SAAS,CAAC,WAAV,CAAsB,kBAAtB,CACE,SAAA,QAAQ,QAAI,CAAA,OAAO,CAAC,cAAc,CAAC,QAAD,CAAf,CAAX,EADV,CAEE,MAFF,CAGE,OAHF,CADkC,EAA7B,CAVI,yEAkBP,gBAlBO,2BAkBU,OAlBV,+HAmBX,SAAS,CAAC,WAAV,CAAsB,UAAtB,CAAiC,OAAjC,EAnBW,uEAqBP,kBArBO,6BAqBY,SArBZ,iIAsBX,OAAO,CAAC,IAAR,CAAa,sDAAb,EAtBW,uEAwBP,uBAxBO,yMAyBJ,eAAiB,CAAA,SAzBb,yEA2BP,YA3BO,uJA4BL,IAAI,CAAA,aAAJ,EA5BK,wEA8BP,mBA9BO,qKA+BL,IAAI,CAAA,aAAJ,EA/BK,wEAiCP,sBAjCO,iCAiCgB,OAjChB,CAiCiC,OAjCjC,sKAkCJ,GAAI,CAAA,OAAJ,CAAoB,SAAA,OAAO,CAAG,CAEnC,OAAO,CAAG,MAAM,CAAC,SAAP,CAAiB,WAAjB,CAA6B,aAA7B,CACR,SAAA,QAAQ,CAAG,CACT,OAAO,CAAC,IAAR,CAAa,sBAAb,CAAqC,CAAE,OAAO,CAAP,OAAF,CAAW,QAAQ,CAAE,cAAc,CAAC,QAAD,CAAnC,CAArC,EACD,CAHO,CAIR,IAJQ,CAKR,OALQ,CAAV,CAOA,OAAO,CAAC,OAAD,CAAP,CACD,CAVM,CAlCI,yEA8CP,uBA9CO,yMA+CJ,GAAI,CAAA,OAAJ,CAA8B,SAAA,OAAO,CAAG,CAC7C,SAAS,CAAC,WAAV,CAAsB,kBAAtB,CACE,iBAAM,CAAA,OAAO,CAAC,CAAE,MAAM,CAAE,SAAV,CAAD,CAAb,EADF,CAEE,cAAa,IAAV,CAAA,IAAU,MAAV,IAAU,CACX,GAAI,IAAI,GAAK,CAAb,CAAwC,CACtC,OAAO,CAAC,CAAE,MAAM,CAAE,QAAV,CAAD,CAAP,CACD,CAFD,IAEO,CACL,OAAO,CAAC,CAAE,MAAM,CAAE,cAAV,CAAD,CAAP,CACD,CACF,CARH,EAUD,CAXM,CA/CI,yEAAf","sourcesContent":["import { EventEmitter } from '@unimodules/core';\n\ninterface Coordinates {\n  latitude: number;\n  longitude: number;\n  altitude?: number;\n  accuracy?: number;\n  altitudeAccuracy?: number;\n  heading?: number;\n  speed?: number;\n}\n\ninterface Position {\n  coords: Coordinates;\n  timestamp: number;\n}\n\ninterface PermissionResult {\n  status: string;\n}\n\nclass GeocoderError extends Error {\n  code: string;\n\n  constructor() {\n    super('Geocoder service is not available for this device.');\n    this.code = 'E_NO_GEOCODER';\n  }\n}\n\nconst emitter = new EventEmitter({} as any);\n\nfunction positionToJSON(position: any): Position | null {\n  if (!position) return null;\n\n  const { coords = {}, timestamp } = position;\n  return {\n    coords: {\n      latitude: coords.latitude,\n      longitude: coords.longitude,\n      altitude: coords.altitude,\n      accuracy: coords.accuracy,\n      altitudeAccuracy: coords.altitudeAccuracy,\n      heading: coords.heading,\n      speed: coords.speed,\n    },\n    timestamp,\n  };\n}\n\nexport default {\n  get name(): string {\n    return 'ExpoLocation';\n  },\n  async getProviderStatusAsync(): Promise<{ locationServicesEnabled: boolean }> {\n    return {\n      locationServicesEnabled: 'geolocation' in navigator,\n    };\n  },\n  async getCurrentPositionAsync(options: Object): Promise<Position | null> {\n    return new Promise<Position | null>((resolve, reject) =>\n      navigator.geolocation.getCurrentPosition(\n        position => resolve(positionToJSON(position)),\n        reject,\n        options\n      )\n    );\n  },\n  async removeWatchAsync(watchId): Promise<void> {\n    navigator.geolocation.clearWatch(watchId);\n  },\n  async watchDeviceHeading(headingId): Promise<void> {\n    console.warn('Location.watchDeviceHeading: is not supported on web');\n  },\n  async hasServicesEnabledAsync(): Promise<boolean> {\n    return 'geolocation' in navigator;\n  },\n  async geocodeAsync(): Promise<Array<any>> {\n    throw new GeocoderError();\n  },\n  async reverseGeocodeAsync(): Promise<Array<any>> {\n    throw new GeocoderError();\n  },\n  async watchPositionImplAsync(watchId: string, options: Object): Promise<string> {\n    return new Promise<string>(resolve => {\n      // @ts-ignore\n      watchId = global.navigator.geolocation.watchPosition(\n        location => {\n          emitter.emit('Expo.locationChanged', { watchId, location: positionToJSON(location) });\n        },\n        null,\n        options\n      );\n      resolve(watchId);\n    });\n  },\n  async requestPermissionsAsync(): Promise<PermissionResult> {\n    return new Promise<PermissionResult>(resolve => {\n      navigator.geolocation.getCurrentPosition(\n        () => resolve({ status: 'granted' }),\n        ({ code }) => {\n          if (code === 1 /* PERMISSION_DENIED */) {\n            resolve({ status: 'denied' });\n          } else {\n            resolve({ status: 'undetermined' });\n          }\n        }\n      );\n    });\n  },\n};\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}